define(["exports","./vendor-22992e2c","./visibility-c7f197c2","./base-fbc1ccef","./useGraphClient-6c0c047b","./functions-f74c7f04","./useSpacesLoading-b404aeae"],(function(e,t,r,i,s,n,u){"use strict";const l=({store:e})=>t.computed((()=>e.getters["runtime/auth/isPublicLinkContextReady"])),a=({store:e})=>t.computed((()=>e.getters["runtime/auth/publicLinkPassword"])),c=({store:e})=>t.computed((()=>e.getters["runtime/auth/publicLinkToken"]));e.useDocumentTitle=function({titleSegments:e,store:i,eventBus:s}){i=i||r.useStore(),s=s||r.eventBus,t.watch(e,(e=>{const r=t.unref(e),n=i.getters.configuration.currentTheme.general.name,u={shortDocumentTitle:r.join(" - "),fullDocumentTitle:[...r,n].join(" - ")};s.publish("runtime.documentTitle.changed",u)}),{immediate:!0})},e.useDriveResolver=(e={})=>{const l=e.store||r.useStore(),{areSpacesLoading:a}=u.useSpacesLoading({store:l}),c=u.useRouteQuery("shareId"),o=u.useRouteQuery("fileId"),d=t.computed((()=>u.queryItemAsString(t.unref(o)))),f=u.useCapabilitySpacesEnabled(l),{graphClient:h}=s.useGraphClient({store:l}),p=t.computed((()=>l.getters["runtime/spaces/spaces"])),m=t.ref(null),g=t.ref(null);return t.watch([e.driveAliasAndItem,a],(([e])=>{if(!e)return m.value=null,void(g.value=null);if(t.unref(m)&&e.startsWith(t.unref(m).driveAlias))return void(g.value=i.urlJoin(e.slice(t.unref(m).driveAlias.length),{leadingSlash:!0}));let s=null,l=null;const a=e.split("/");if(e.startsWith("public/")){const[r,...i]=e.split("/").slice(1);s=t.unref(p).find((e=>e.id===r)),l=i.join("/")}else if(e.startsWith("share/")){const[i,...a]=e.split("/").slice(1);s=n.buildShareSpaceResource({shareId:u.queryItemAsString(t.unref(c)),shareName:t.unref(i),serverUrl:r.configurationManager.serverUrl}),l=a.join("/")}else s=t.unref(f)&&t.unref(d)?t.unref(p).find((e=>t.unref(d).startsWith(`${e.fileId}`))):t.unref(p).find((t=>{if(!e.startsWith(t.driveAlias))return!1;const r=t.driveAlias.split("/");return!(a.length<r.length||a.slice(0,r.length).join("/")!==t.driveAlias)&&t})),s&&(l=e.slice(s.driveAlias.length));m.value=s,g.value=i.urlJoin(l,{leadingSlash:!0})}),{immediate:!0}),t.watch(m,(e=>{if(e&&!["public","share","personal"].includes(e.driveType))return l.dispatch("runtime/spaces/loadSpaceMembers",{graphClient:t.unref(h),space:e})}),{immediate:!0}),{space:m,item:g,itemId:d}},e.usePublicLinkContext=l,e.usePublicLinkPassword=a,e.usePublicLinkToken=c,e.useRequest=function(e={}){const i=e.clientService??s.useClientService(),n=e.store??r.useStore(),u=l({store:n}),o=a({store:n}),d=s.useAccessToken({store:n}),f=c({store:n});return{makeRequest:(e,r,s)=>{let n;return n=t.unref(d)?i.httpAuthenticated(t.unref(d)):i.httpUnAuthenticated,(s=s||{}).headers=s.headers||{},t.unref(u)&&(t.unref(o)&&(s.headers.Authorization="Basic "+t.Buffer.from(["public",t.unref(o)].join(":")).toString("base64")),t.unref(f)&&(s.headers["public-token"]=t.unref(f))),s.method=e,s.url=r,n.request(s)}}}}));
