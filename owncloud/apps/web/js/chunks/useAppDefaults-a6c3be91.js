define(["exports","./vendor-22992e2c","./useSpacesLoading-b404aeae","./visibility-c7f197c2","./useGraphClient-6c0c047b","./base-fbc1ccef","./useDriveResolver-be2aa3cc"],(function(e,t,n,r,i,u,o){"use strict";function a({store:e,applicationId:n}){return{applicationMeta:t.computed((()=>{const t=e.getters.apps[n];if(!t)throw new Error(`useAppConfig: could not find config for applicationId: ${n}`);return t||{}}))}}function c(e){const n=a(e);return{applicationConfig:t.computed((()=>t.unref(n.applicationMeta).config||{}))}}function l({clientService:{webdav:e}}){const r=n.useCapabilityCoreSupportUrlSigning(),{webdav:{getFileUrl:u,revokeUrl:o}}=i.useClientService();return{getUrlForResource:(e,n,i)=>u(e,n,{isUrlSigningEnabled:t.unref(r),...i}),revokeUrl:o,getFileContents:(n,r)=>e.getFileContents(t.unref(t.unref(n).space),{path:t.unref(t.unref(n).item)},{...r}),getFileInfo:async(n,r={})=>e.getFileInfo(t.unref(t.unref(n).space),{path:t.unref(t.unref(n).item),fileId:t.unref(t.unref(n).itemId)},r),putFileContents:(n,r)=>e.putFileContents(t.unref(t.unref(n).space),{path:t.unref(t.unref(n).item),...r})}}function s({store:e,currentRoute:r,clientService:i}){const o=t.ref(!1),a=t.computed((()=>e.getters["Files/activeFiles"])),{webdav:c}=i,{replaceInvalidFileRoute:s}=n.useFileRouteReplace(),{getFileInfo:p}=l({clientService:i}),f=t.getCurrentInstance().proxy.$authService;return{isFolderLoading:o,loadFolderForFileContext:async n=>{if(!e.getters.activeFile||""===e.getters.activeFile.path){o.value=!0,e.commit("Files/CLEAR_CURRENT_FILES_LIST",null);try{n=t.unref(n);const r=t.unref(n.space),i=await p(n,{davProperties:[u.DavProperty.FileId]});s({space:r,resource:i,path:t.unref(n.item),fileId:t.unref(n.itemId)});const o=t.dirname(i.path),{resource:a,children:l}=await c.listFiles(r,{path:o});"file"===a.type?e.commit("Files/LOAD_FILES",{currentFolder:a,files:[a]}):e.commit("Files/LOAD_FILES",{currentFolder:a,files:l})}catch(n){if(401===n.statusCode)return f.handleAuthError(t.unref(r));e.commit("Files/SET_CURRENT_FOLDER",null),console.error(n)}o.value=!1}},activeFiles:a}}e.useAppConfig=c,e.useAppDefaults=function(e){const p=n.useRouter(),f=r.useStore(),d=n.useRoute(),m=e.clientService??i.useClientService(),F=e.applicationId,v=o.usePublicLinkContext({store:f}),g=n.useRouteParam("driveAliasAndItem"),{space:I,item:C,itemId:S}=o.useDriveResolver({store:f,driveAliasAndItem:g}),R=t.computed((()=>{let e;return e=t.unref(I)?u.urlJoin(t.unref(I).webDavPath,t.unref(C)):u.urlJoin(t.unref(d).params.filePath),{path:e,driveAliasAndItem:t.unref(g),space:t.unref(I),item:t.unref(C),itemId:t.unref(S),fileName:t.basename(e),routeName:n.queryItemAsString(t.unref(d).query[n.contextRouteNameKey]),...n.contextQueryToFileContextProps(t.unref(d).query)}}));return function({store:e,document:n,applicationId:r,applicationName:i,currentFileContext:u}){const c=a({applicationId:r,store:e}),l=t.computed((()=>{const e=t.basename(t.unref(t.unref(u).fileName)),n=t.unref(t.unref(c).applicationMeta);return[e,t.unref(i)||n.name||n.id].filter(Boolean)}));o.useDocumentTitle({titleSegments:l})}({store:f,document:document,applicationId:F,applicationName:e.applicationName,currentFileContext:R}),{isPublicLinkContext:v,currentFileContext:R,...c({store:f,...e}),...n.useAppNavigation({router:p,currentFileContext:R}),...l({clientService:m}),...s({clientService:m,store:f,currentRoute:d}),...o.useRequest({clientService:m,store:f,currentRoute:t.unref(d)})}},e.useAppFileHandling=l,e.useAppFolderHandling=s}));
